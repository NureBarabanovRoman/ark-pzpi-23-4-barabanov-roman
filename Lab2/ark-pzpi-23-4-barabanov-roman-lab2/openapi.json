{"openapi":"3.1.0","info":{"title":"Polling System","version":"3.3"},"paths":{"/auth/register":{"post":{"tags":["Auth"],"summary":"Register","operationId":"register_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/login":{"post":{"tags":["Auth"],"summary":"Login","operationId":"login_auth_login_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_auth_login_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/users":{"get":{"tags":["Admin"],"summary":"List Users","operationId":"list_users_admin_users_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/UserRead"},"type":"array","title":"Response List Users Admin Users Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/admin/users/{user_id}/role":{"patch":{"tags":["Admin"],"summary":"Change Role","operationId":"change_role_admin_users__user_id__role_patch","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRoleUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/logs":{"get":{"tags":["Admin"],"summary":"View Logs","operationId":"view_logs_admin_logs_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/SystemLogRead"},"type":"array","title":"Response View Logs Admin Logs Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/polls/":{"post":{"tags":["Polls"],"summary":"Create Poll","operationId":"create_poll_polls__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PollCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PollRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/polls/my":{"get":{"tags":["Polls"],"summary":"List My Polls","operationId":"list_my_polls_polls_my_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/PollRead"},"type":"array","title":"Response List My Polls Polls My Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/polls/{poll_id}":{"delete":{"tags":["Polls"],"summary":"Delete Poll","operationId":"delete_poll_polls__poll_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"poll_id","in":"path","required":true,"schema":{"type":"string","title":"Poll Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/polls/{poll_id}/analytics":{"get":{"tags":["Public"],"summary":"Get Analytics","operationId":"get_analytics_polls__poll_id__analytics_get","parameters":[{"name":"poll_id","in":"path","required":true,"schema":{"type":"string","title":"Poll Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PollReadDetailed"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/iot/register":{"post":{"tags":["IoT"],"summary":"Register Device","operationId":"register_device_iot_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeviceRegister"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/iot/click":{"post":{"tags":["IoT"],"summary":"Smart Click","operationId":"smart_click_iot_click_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IoTClick"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_login_auth_login_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"^password$"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","format":"password","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"format":"password","title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_auth_login_post"},"DeviceRegister":{"properties":{"device_id":{"type":"string","title":"Device Id"},"device_type":{"type":"string","title":"Device Type","default":"button"},"room_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Room Id"}},"type":"object","required":["device_id"],"title":"DeviceRegister"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IoTClick":{"properties":{"device_id":{"type":"string","title":"Device Id"},"button_index":{"type":"integer","title":"Button Index"}},"type":"object","required":["device_id","button_index"],"title":"IoTClick"},"OptionBase":{"properties":{"text":{"type":"string","title":"Text"}},"type":"object","required":["text"],"title":"OptionBase"},"OptionRead":{"properties":{"text":{"type":"string","title":"Text"},"id":{"type":"string","title":"Id"},"vote_count":{"type":"integer","title":"Vote Count"}},"type":"object","required":["text","id","vote_count"],"title":"OptionRead"},"OptionReadWithStats":{"properties":{"id":{"type":"string","title":"Id"},"text":{"type":"string","title":"Text"},"vote_count":{"type":"integer","title":"Vote Count"},"percentage":{"type":"number","title":"Percentage"},"margin_of_error":{"type":"number","title":"Margin Of Error"}},"type":"object","required":["id","text","vote_count","percentage","margin_of_error"],"title":"OptionReadWithStats"},"PollAnalytics":{"properties":{"total_votes":{"type":"integer","title":"Total Votes"},"controversy_index":{"type":"number","title":"Controversy Index"},"consensus_status":{"type":"string","title":"Consensus Status"}},"type":"object","required":["total_votes","controversy_index","consensus_status"],"title":"PollAnalytics"},"PollCreate":{"properties":{"title":{"type":"string","title":"Title"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"room_id":{"type":"string","title":"Room Id"},"options":{"items":{"$ref":"#/components/schemas/OptionBase"},"type":"array","title":"Options"}},"type":"object","required":["title","room_id","options"],"title":"PollCreate"},"PollRead":{"properties":{"id":{"type":"string","title":"Id"},"title":{"type":"string","title":"Title"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"room_id":{"type":"string","title":"Room Id"},"is_active":{"type":"boolean","title":"Is Active","default":true},"owner_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Owner Id"},"options":{"items":{"$ref":"#/components/schemas/OptionRead"},"type":"array","title":"Options"}},"type":"object","required":["id","title","room_id","options"],"title":"PollRead"},"PollReadDetailed":{"properties":{"id":{"type":"string","title":"Id"},"title":{"type":"string","title":"Title"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"room_id":{"type":"string","title":"Room Id"},"is_active":{"type":"boolean","title":"Is Active","default":true},"owner_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Owner Id"},"options":{"items":{"$ref":"#/components/schemas/OptionReadWithStats"},"type":"array","title":"Options"},"analytics":{"$ref":"#/components/schemas/PollAnalytics"}},"type":"object","required":["id","title","room_id","options","analytics"],"title":"PollReadDetailed"},"SystemLogRead":{"properties":{"id":{"type":"integer","title":"Id"},"user_email":{"type":"string","title":"User Email"},"action":{"type":"string","title":"Action"},"details":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Details"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp"}},"type":"object","required":["id","user_email","action","details","timestamp"],"title":"SystemLogRead"},"Token":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type"},"role":{"type":"string","title":"Role","default":"user"}},"type":"object","required":["access_token","token_type"],"title":"Token"},"UserCreate":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"UserCreate"},"UserRead":{"properties":{"id":{"type":"string","title":"Id"},"email":{"type":"string","title":"Email"},"role":{"type":"string","title":"Role"}},"type":"object","required":["id","email","role"],"title":"UserRead"},"UserRoleUpdate":{"properties":{"role":{"type":"string","title":"Role"}},"type":"object","required":["role"],"title":"UserRoleUpdate"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"auth/login"}}}}}}